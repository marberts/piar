<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Make a price index aggregation structure — aggregation_structure • piar</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Make a price index aggregation structure — aggregation_structure"><meta name="description" content="Create a price index aggregation structure from a hierarchical
classification and aggregation weights that can be used to aggregate
elemental indexes."><meta property="og:description" content="Create a price index aggregation structure from a hierarchical
classification and aggregation weights that can be used to aggregate
elemental indexes."><meta property="og:image" content="https://marberts.github.io/piar/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">piar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.8.1.9013</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/piar.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/adjust-weights.html">Adjusting annual weights</a></li>
    <li><a class="dropdown-item" href="../articles/contributions.html">Contributions</a></li>
    <li><a class="dropdown-item" href="../articles/imputation.html">Imputation</a></li>
    <li><a class="dropdown-item" href="../articles/index-number-formulas.html">Index-number formulas</a></li>
    <li><a class="dropdown-item" href="../articles/matrix-aggregation.html">Matrix aggregation</a></li>
    <li><a class="dropdown-item" href="../articles/multiple-baskets.html">Aggregating across baskets</a></li>
    <li><a class="dropdown-item" href="../articles/multiple-data-sources.html">Multiple sources of data</a></li>
    <li><a class="dropdown-item" href="../articles/multiple-dimensions.html">Aggregating across dimensions</a></li>
    <li><a class="dropdown-item" href="../articles/superlative-aggregation.html">Superlative aggregation</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/marberts/piar/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Make a price index aggregation structure</h1>
      <small class="dont-index">Source: <a href="https://github.com/marberts/piar/blob/main/R/aggregation_structure.R" class="external-link"><code>R/aggregation_structure.R</code></a></small>
      <div class="d-none name"><code>aggregation_structure.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Create a price index aggregation structure from a hierarchical
classification and aggregation weights that can be used to aggregate
elemental indexes.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">aggregation_structure</span><span class="op">(</span><span class="va">x</span>, weights <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A list of character vectors that give the codes/labels for each
level of the classification, ordered so that moving down the list goes down
the hierarchy. The last vector gives the elemental aggregates, which should
have no duplicates. All vectors should be the same length, without
<code>NA</code>s, and there should be no duplicates across different levels of
<code>x</code>.</p></dd>


<dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>A numeric vector of aggregation weights for the elemental
aggregates (i.e., the last vector in <code>x</code>), or something that can be coerced
into one. The default is to give each elemental aggregate the same weight.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A price index aggregation structure of class <code>piar_aggregation_structure</code>.
This is a list-S3 class with the following components.</p>
<dl><dt>child</dt>
<dd><p>A nested list that gives the positions of the immediate
children for each node in each level of the aggregation structure above the
terminal nodes.</p></dd>

<dt>parent</dt>
<dd><p>A list that gives the position of the
immediate parent for each node of the aggregation structure below the
initial nodes.</p></dd>

<dt>levels</dt>
<dd><p>A list of character vectors that give the levels of <code>x</code>.</p></dd>

<dt>weights</dt>
<dd><p>A vector giving the weight for each elemental
aggregate.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="warning">Warning<a class="anchor" aria-label="anchor" href="#warning"></a></h2>
    <p>The <code>aggregation_structure()</code> function does its best
to check its arguments, but there should be no expectation that the result
of <code>aggregation_structure()</code> will make any sense if <code>x</code> does not
represent a nested hierarchy.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="aggregate.piar_index.html">aggregate()</a></code> to aggregate price indexes made
with <code><a href="elemental_index.html">elemental_index()</a></code>.</p>
<p><code><a href="expand_classification.html">expand_classification()</a></code> to make <code>x</code> from a character
representation of a hierarchical aggregation structure.</p>
<p><code><a href="as_aggregation_structure.html">as_aggregation_structure()</a></code> to coerce tabular data into an
aggregation structure.</p>
<p><code><a href="as.matrix.piar_aggregation_structure.html">as.data.frame()</a></code> and
<code><a href="as.matrix.piar_aggregation_structure.html">as.matrix()</a></code> to coerce an
aggregation structure into a tabular form.</p>
<p><code><a href="weights.piar_aggregation_structure.html">weights()</a></code> to get the
weights for an aggregation structure.</p>
<p><code><a href="update.piar_aggregation_structure.html">update()</a></code> for updating a
price index aggregation structure with an aggregated index.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># A simple aggregation structure</span></span></span>
<span class="r-in"><span><span class="co">#            1</span></span></span>
<span class="r-in"><span><span class="co">#      |-----+-----|</span></span></span>
<span class="r-in"><span><span class="co">#      11          12</span></span></span>
<span class="r-in"><span><span class="co">#  |---+---|       |</span></span></span>
<span class="r-in"><span><span class="co">#  111     112     121</span></span></span>
<span class="r-in"><span><span class="co">#  (1)     (3)     (4)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">aggregation_weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  level1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"1"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  level2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"11"</span>, <span class="st">"11"</span>, <span class="st">"12"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  ea     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"111"</span>, <span class="st">"112"</span>, <span class="st">"121"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">aggregation_structure</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">aggregation_weights</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  weights <span class="op">=</span> <span class="va">aggregation_weights</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Aggregation structure for 3 elemental aggregates with 2 levels above the elemental aggregates </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   level1 level2  ea weight</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      1     11 111      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      1     11 112      3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      1     12 121      4</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The aggregation structure can also be made by expanding the</span></span></span>
<span class="r-in"><span><span class="co"># elemental aggregates</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">aggregation_weights</span>,</span></span>
<span class="r-in"><span>  <span class="fu">aggregation_structure</span><span class="op">(</span><span class="fu"><a href="expand_classification.html">expand_classification</a></span><span class="op">(</span><span class="va">ea</span><span class="op">)</span>, <span class="va">weight</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Aggregation structure for 3 elemental aggregates with 2 levels above the elemental aggregates </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   level1 level2  ea weight</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      1     11 111      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      1     11 112      3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      1     12 121      4</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Steve Martin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

