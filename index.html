<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Price Index Aggregation • piar</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" sizes="any" href="favicon.ico">
<link rel="manifest" href="site.webmanifest">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Price Index Aggregation">
<meta name="description" content="Most price indexes are made with a two-step procedure, where period-over-period elemental indexes are first calculated for a collection of elemental aggregates at each point in time, and then aggregated according to a price index aggregation structure. These indexes can then be chained together to form a time series that gives the evolution of prices with respect to a fixed base period. This package contains a collection of functions that revolve around this work flow, making it easy to build standard price indexes, and implement the methods described by Balk (2008, &lt;doi:10.1017/CBO9780511720758&gt;), von der Lippe (2007, &lt;doi:10.3726/978-3-653-01120-3&gt;), and the CPI manual (2020, &lt;doi:10.5089/9781484354841.069&gt;) for bilateral price indexes.">
<meta property="og:description" content="Most price indexes are made with a two-step procedure, where period-over-period elemental indexes are first calculated for a collection of elemental aggregates at each point in time, and then aggregated according to a price index aggregation structure. These indexes can then be chained together to form a time series that gives the evolution of prices with respect to a fixed base period. This package contains a collection of functions that revolve around this work flow, making it easy to build standard price indexes, and implement the methods described by Balk (2008, &lt;doi:10.1017/CBO9780511720758&gt;), von der Lippe (2007, &lt;doi:10.3726/978-3-653-01120-3&gt;), and the CPI manual (2020, &lt;doi:10.5089/9781484354841.069&gt;) for bilateral price indexes.">
<meta property="og:image" content="https://marberts.github.io/piar/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">piar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.8.2.9008</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="articles/piar.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/multiple-baskets.html">Aggregating across baskets</a></li>
    <li><a class="dropdown-item" href="articles/multiple-dimensions.html">Aggregating across dimensions</a></li>
    <li><a class="dropdown-item" href="articles/matrix-aggregation.html">Matrix aggregation</a></li>
    <li><a class="dropdown-item" href="articles/superlative-aggregation.html">Superlative aggregation</a></li>
    <li><a class="dropdown-item" href="articles/subperiods.html">Aggregating over subperiods</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="articles/index.html">More articles...</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/marberts/piar/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="price-index-aggregation-in-r-">Price Index Aggregation in R 
<a class="anchor" aria-label="anchor" href="#price-index-aggregation-in-r-"></a>
</h1>
</div>
<!-- badges: start -->

<p>Most price indexes are made with a two-step procedure, where period-over-period <em>elemental indexes</em> are first calculated for a collection of <em>elemental aggregates</em> at each point in time, and then aggregated according to a <em>price index aggregation structure</em>. These indexes can then be chained together to form a time series that gives the evolution of prices with respect to a fixed base period. This package contains a collection of functions that revolve around this work flow, making it easy to build standard price indexes, and implement the methods described by Balk (2008), von der Lippe (2007), and the CPI manual (2020) / PPI manual (2004) for bilateral price indexes.</p>
<p>The tools in this package are designed to be useful for both researching new sources of data and methods to construct price indexes, and the regular production of price statistics. It is targeted towards economists, statisticians, and data scientists working at national statistical agencies, central banks, financial institutions, and in academia that want to measure and study the evolution of prices over time.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Get the stable version from CRAN.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"piar"</span><span class="op">)</span></span></code></pre></div>
<p>The development version can be installed from R-Universe</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"piar"</span>, repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"https://marberts.r-universe.dev"</span>, <span class="st">"https://cloud.r-project.org"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>or directly from Github.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"marberts/piar"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>There are several detailed vignette showing how to use <strong>piar</strong>: <code>browseVignettes("piar")</code>. But the basic work flow is fairly simple.</p>
<p>The starting point is to make period-over-period elemental price indexes with the <code><a href="reference/elemental_index.html">elemental_index()</a></code> function.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://marberts.github.io/piar/">piar</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make Jevons business-level elemental indexes</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ms_prices</span><span class="op">)</span></span>
<span><span class="co">#&gt;   period business product price</span></span>
<span><span class="co">#&gt; 1 202001       B1       1  1.14</span></span>
<span><span class="co">#&gt; 2 202001       B1       2    NA</span></span>
<span><span class="co">#&gt; 3 202001       B1       3  6.09</span></span>
<span><span class="co">#&gt; 4 202001       B2       4  6.23</span></span>
<span><span class="co">#&gt; 5 202001       B2       5  8.61</span></span>
<span><span class="co">#&gt; 6 202001       B2       6  6.40</span></span>
<span></span>
<span><span class="va">elementals</span> <span class="op">&lt;-</span> <span class="va">ms_prices</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span></span>
<span>    relative <span class="op">=</span> <span class="fu"><a href="reference/price_relative.html">price_relative</a></span><span class="op">(</span><span class="va">price</span>, period <span class="op">=</span> <span class="va">period</span>, product <span class="op">=</span> <span class="va">product</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/elemental_index.html">elemental_index</a></span><span class="op">(</span><span class="va">relative</span> <span class="op">~</span> <span class="va">period</span> <span class="op">+</span> <span class="va">business</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">elementals</span></span>
<span><span class="co">#&gt; Period-over-period price index for 4 levels over 4 time periods </span></span>
<span><span class="co">#&gt;       time</span></span>
<span><span class="co">#&gt; levels 202001    202002    202003   202004</span></span>
<span><span class="co">#&gt;     B1      1 0.8949097 0.3342939      NaN</span></span>
<span><span class="co">#&gt;     B2      1       NaN       NaN 2.770456</span></span>
<span><span class="co">#&gt;     B3      1 2.0200036 1.6353355 0.537996</span></span>
<span><span class="co">#&gt;     B4    NaN       NaN       NaN 4.576286</span></span></code></pre></div>
<p>And an aggregation structure.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make an aggregation structure from businesses to higher-level</span></span>
<span><span class="co"># industrial classifications</span></span>
<span></span>
<span><span class="va">ms_weights</span></span>
<span><span class="co">#&gt;   business classification weight</span></span>
<span><span class="co">#&gt; 1       B1             11    553</span></span>
<span><span class="co">#&gt; 2       B2             11    646</span></span>
<span><span class="co">#&gt; 3       B3             11    312</span></span>
<span><span class="co">#&gt; 4       B4             12    622</span></span>
<span><span class="co">#&gt; 5       B5             12    330</span></span>
<span></span>
<span><span class="va">ms_weights</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"level1"</span>, <span class="st">"level2"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="reference/expand_classification.html">expand_classification</a></span><span class="op">(</span><span class="va">ms_weights</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pias</span> <span class="op">&lt;-</span> <span class="va">ms_weights</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"level1"</span>, <span class="st">"level2"</span>, <span class="st">"business"</span>, <span class="st">"weight"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">pias</span></span>
<span><span class="co">#&gt;   level1 level2 business weight</span></span>
<span><span class="co">#&gt; 1      1     11       B1    553</span></span>
<span><span class="co">#&gt; 2      1     11       B2    646</span></span>
<span><span class="co">#&gt; 3      1     11       B3    312</span></span>
<span><span class="co">#&gt; 4      1     12       B4    622</span></span>
<span><span class="co">#&gt; 5      1     12       B5    330</span></span></code></pre></div>
<p>The <code><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate()</a></code> method can then be used to aggregate the elemental indexes according to the aggregation structure (the first three rows below) and fill in missing elemental indexes while maintaining consistency in aggregation. There are a variety of methods to work with these index objects, such as chaining them over time.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Aggregate elemental indexes with an arithmetic index</span></span>
<span></span>
<span><span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">elementals</span>, <span class="va">pias</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Chain them to get a time series</span></span>
<span></span>
<span><span class="fu"><a href="reference/chain.html">chain</a></span><span class="op">(</span><span class="va">index</span><span class="op">)</span></span>
<span><span class="co">#&gt; Fixed-base price index for 8 levels over 4 time periods </span></span>
<span><span class="co">#&gt;       time</span></span>
<span><span class="co">#&gt; levels 202001    202002    202003    202004</span></span>
<span><span class="co">#&gt;     1       1 1.3007239 1.3827662 3.7815355</span></span>
<span><span class="co">#&gt;     11      1 1.3007239 1.3827662 2.1771866</span></span>
<span><span class="co">#&gt;     12      1 1.3007239 1.3827662 6.3279338</span></span>
<span><span class="co">#&gt;     B1      1 0.8949097 0.2991629 0.4710366</span></span>
<span><span class="co">#&gt;     B2      1 1.3007239 1.3827662 3.8308934</span></span>
<span><span class="co">#&gt;     B3      1 2.0200036 3.3033836 1.7772072</span></span>
<span><span class="co">#&gt;     B4      1 1.3007239 1.3827662 6.3279338</span></span>
<span><span class="co">#&gt;     B5      1 1.3007239 1.3827662 6.3279338</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="contributing">Contributing<a class="anchor" aria-label="anchor" href="#contributing"></a>
</h2>
<p>All contributions are welcome. Please start by opening an issue on GitHub to report any bugs or suggest improvements and new features. See the contribution guidelines for this project for more information.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Balk, B. M. (2008). <em>Price and Quantity Index Numbers</em>. Cambridge University Press.</p>
<p>Chiru, R., Huang, N., Lequain, M. Smith, P., and Wright, A. (2015). <em>The Canadian Consumer Price Index Reference Paper</em>, Statistics Canada catalogue 62-553-X. Statistics Canada.</p>
<p>ILO, IMF, UNECE, OECD, and World Bank. (2004). <em>Producer Price Index Manual: Theory and Practice</em>. International Monetary Fund.</p>
<p>IMF, ILO, Eurostat, UNECE, OECD, and World Bank. (2020). <em>Consumer Price Index Manual: Concepts and Methods</em>. International Monetary Fund.</p>
<p>von der Lippe, P. (2007). <em>Index Theory and Price Statistics</em>. Peter Lang.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=piar" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/marberts/piar/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/marberts/piar/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing piar</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Steve Martin <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0000-0003-2544-9480" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=piar" class="external-link"><img src="https://www.r-pkg.org/badges/version/piar" alt="CRAN status"></a></li>
<li><a href="https://marberts.r-universe.dev/piar" class="external-link"><img src="https://marberts.r-universe.dev/badges/piar" alt="piar status badge"></a></li>
<li><a href="https://anaconda.org/conda-forge/r-piar" class="external-link"><img src="https://img.shields.io/conda/vn/conda-forge/r-piar.svg" alt="Conda Version"></a></li>
<li><a href="https://github.com/marberts/piar/actions" class="external-link"><img src="https://github.com/marberts/piar/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/marberts/piar" class="external-link"><img src="https://codecov.io/gh/marberts/piar/graph/badge.svg?token=lHDHsGHsLd" alt="codecov"></a></li>
<li><a href="https://zenodo.org/doi/10.5281/zenodo.10110046" class="external-link"><img src="https://zenodo.org/badge/370889275.svg" alt="DOI"></a></li>
<li><a href="https://github.com/SNStatComp/awesome-official-statistics-software" class="external-link"><img src="https://awesome.re/mentioned-badge.svg" alt="Mentioned in Awesome Official Statistics"></a></li>
<li><a href="https://doi.org/10.21105/joss.06781" class="external-link"><img src="https://joss.theoj.org/papers/10.21105/joss.06781/status.svg" alt="DOI"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Steve Martin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
