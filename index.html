<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Most price indexes are made with a two-step procedure, where
    period-over-period elemental indexes are first calculated for a collection
    of elemental aggregates at each point in time, and then aggregated according
    to a price index aggregation structure. These indexes can then be chained
    together to form a time series that gives the evolution of prices with
    respect to a fixed base period. This package contains a collections of
    functions that revolve around this work flow, making it easy to build
    standard price indexes, and implement the methods described by
    Balk (2008, ISBN:978-1-107-40496-0), von der Lippe (2001,
    ISBN:3-8246-0638-0), and the CPI manual (2020, ISBN:978-1-51354-298-0)
    for bilateral price indexes.">
<title>Price Index Aggregation â€¢ piar</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Price Index Aggregation">
<meta property="og:description" content="Most price indexes are made with a two-step procedure, where
    period-over-period elemental indexes are first calculated for a collection
    of elemental aggregates at each point in time, and then aggregated according
    to a price index aggregation structure. These indexes can then be chained
    together to form a time series that gives the evolution of prices with
    respect to a fixed base period. This package contains a collections of
    functions that revolve around this work flow, making it easy to build
    standard price indexes, and implement the methods described by
    Balk (2008, ISBN:978-1-107-40496-0), von der Lippe (2001,
    ISBN:3-8246-0638-0), and the CPI manual (2020, ISBN:978-1-51354-298-0)
    for bilateral price indexes.">
<meta property="og:image" content="https://marberts/github.io/piar/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">piar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.0.9003</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="articles/piar.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/marberts/piar/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="price-index-aggregation-in-r-">Price Index Aggregation in R 
<a class="anchor" aria-label="anchor" href="#price-index-aggregation-in-r-"></a>
</h1>
</div>
<!-- badges: start -->

<p>Most price indexes are made with a two-step procedure, where period-over-period <em>elemental indexes</em> are first calculated for a collection of <em>elemental aggregates</em> at each point in time, and then aggregated according to a <em>price index aggregation structure</em>. These indexes can then be chained together to form a time series that gives the evolution of prices with respect to a fixed base period. This package contains a collections of functions that revolve around this work flow, making it easy to build standard price indexes, and implement the methods described by Balk (2008), von der Lippe (2001), and the CPI manual (2020) for bilateral price indexes.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Get the stable version from CRAN.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"piar"</span><span class="op">)</span></span></code></pre></div>
<p>The development version can be installed from R-Universe</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"piar"</span>, repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"https://marberts.r-universe.dev"</span>, <span class="st">"https://cloud.r-project.org"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>or directly from Github.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"marberts/piar"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>There is a detailed vignette showing how to use <strong>piar</strong>: <code>browseVignettes("piar")</code>. But the basic work flow is fairly simple.</p>
<p>The starting point is to make period-over-period elemental price indexes with the <code><a href="reference/elemental_index.html">elemental_index()</a></code> function.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://marberts.github.io/piar/" class="external-link">piar</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make Jevons business-level elemental indexes</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ms_prices</span><span class="op">)</span></span>
<span><span class="co">#&gt;   period business product price</span></span>
<span><span class="co">#&gt; 1 202001       B1       1  1.14</span></span>
<span><span class="co">#&gt; 2 202001       B1       2    NA</span></span>
<span><span class="co">#&gt; 3 202001       B1       3  6.09</span></span>
<span><span class="co">#&gt; 4 202001       B2       4  6.23</span></span>
<span><span class="co">#&gt; 5 202001       B2       5  8.61</span></span>
<span><span class="co">#&gt; 6 202001       B2       6  6.40</span></span>
<span></span>
<span><span class="va">elementals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span></span>
<span>  <span class="va">ms_prices</span>, </span>
<span>  <span class="fu"><a href="reference/elemental_index.html">elemental_index</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="reference/price_relative.html">price_relative</a></span><span class="op">(</span><span class="va">price</span>, <span class="va">period</span>, <span class="va">product</span><span class="op">)</span>, </span>
<span>    <span class="va">period</span>, <span class="va">business</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">elementals</span></span>
<span><span class="co">#&gt; Period-over-period price index for 4 levels over 4 time periods </span></span>
<span><span class="co">#&gt;    202001    202002    202003   202004</span></span>
<span><span class="co">#&gt; B1      1 0.8949097 0.3342939      NaN</span></span>
<span><span class="co">#&gt; B2      1       NaN       NaN 2.770456</span></span>
<span><span class="co">#&gt; B3      1 2.0200036 1.6353355 0.537996</span></span>
<span><span class="co">#&gt; B4    NaN       NaN       NaN 4.576286</span></span></code></pre></div>
<p>And an aggregation structure with the <code><a href="reference/aggregation_structure.html">aggregation_structure()</a></code> function.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make an aggregation structure from businesses to higher-level</span></span>
<span><span class="co"># industrial classifications</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ms_weights</span><span class="op">)</span></span>
<span><span class="co">#&gt;   business classification weight</span></span>
<span><span class="co">#&gt; 1       B1             11    553</span></span>
<span><span class="co">#&gt; 2       B2             11    646</span></span>
<span><span class="co">#&gt; 3       B3             11    312</span></span>
<span><span class="co">#&gt; 4       B4             12    622</span></span>
<span><span class="co">#&gt; 5       B5             12    330</span></span>
<span></span>
<span><span class="va">pias</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span></span>
<span>  <span class="va">ms_weights</span>,</span>
<span>  <span class="fu"><a href="reference/aggregation_structure.html">aggregation_structure</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="reference/expand_classification.html">expand_classification</a></span><span class="op">(</span><span class="va">classification</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">business</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="va">weight</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">pias</span></span>
<span><span class="co">#&gt; Aggregation structure for 5 elemental aggregates with 2 levels above the elemental aggregates </span></span>
<span><span class="co">#&gt;   level1 level2 ea weight</span></span>
<span><span class="co">#&gt; 1      1     11 B1    553</span></span>
<span><span class="co">#&gt; 2      1     11 B2    646</span></span>
<span><span class="co">#&gt; 3      1     11 B3    312</span></span>
<span><span class="co">#&gt; 4      1     12 B4    622</span></span>
<span><span class="co">#&gt; 5      1     12 B5    330</span></span></code></pre></div>
<p>The <code><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate()</a></code> method can then be used to aggregate the elemental indexes according to the aggregation structure. There are a variety of methods to work with these index objects, such as chaining them over time.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Aggregate elemental indexes with an arithmetic index</span></span>
<span></span>
<span><span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">elementals</span>, <span class="va">pias</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Chain them to get a time series</span></span>
<span></span>
<span><span class="fu"><a href="reference/chain.html">chain</a></span><span class="op">(</span><span class="va">index</span><span class="op">)</span></span>
<span><span class="co">#&gt; Aggregate fixed-base price index for 8 levels over 4 time periods </span></span>
<span><span class="co">#&gt;    202001    202002    202003    202004</span></span>
<span><span class="co">#&gt; 1       1 1.3007239 1.3827662 3.7815355</span></span>
<span><span class="co">#&gt; 11      1 1.3007239 1.3827662 2.1771866</span></span>
<span><span class="co">#&gt; 12      1 1.3007239 1.3827662 6.3279338</span></span>
<span><span class="co">#&gt; B1      1 0.8949097 0.2991629 0.4710366</span></span>
<span><span class="co">#&gt; B2      1 1.3007239 1.3827662 3.8308934</span></span>
<span><span class="co">#&gt; B3      1 2.0200036 3.3033836 1.7772072</span></span>
<span><span class="co">#&gt; B4      1 1.3007239 1.3827662 6.3279338</span></span>
<span><span class="co">#&gt; B5      1 1.3007239 1.3827662 6.3279338</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Balk, B. M. (2008). <em>Price and Quantity Index Numbers</em>. Cambridge University Press.</p>
<p>Chiru, R., Huang, N., Lequain, M. Smith, P., and Wright, A. (2015). <em>The Canadian Consumer Price Index Reference Paper</em>, Statistics Canada catalogue 62-553-X. Statistics Canada.</p>
<p>ILO, IMF, OECD, Eurostat, UN, and World Bank. (2020). <em>Consumer Price Index Manual: Theory and Practice</em>. International Monetary Fund.</p>
<p>von der Lippe, P. (2001). <em>Chain Indices: A Study in Price Index Theory</em>, Spectrum of Federal Statistics vol.Â 16. Federal Statistical Office, Wiesbaden.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=piar" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/marberts/piar/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/marberts/piar/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing piar</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Steve Martin <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0000-0003-2544-9480" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=piar" class="external-link"><img src="https://www.r-pkg.org/badges/version/piar" alt="CRAN status"></a></li>
<li><a href="https://marberts.r-universe.dev" class="external-link"><img src="https://marberts.r-universe.dev/badges/piar" alt="piar status badge"></a></li>
<li><a href="https://github.com/marberts/piar/actions" class="external-link"><img src="https://github.com/marberts/piar/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://codecov.io/gh/marberts/piar" class="external-link"><img src="https://codecov.io/gh/marberts/piar/graph/badge.svg?token=lHDHsGHsLd" alt="codecov"></a></li>
<li><a href="https://zenodo.org/doi/10.5281/zenodo.10110046" class="external-link"><img src="https://zenodo.org/badge/370889275.svg" alt="DOI"></a></li>
<li><a href="http://www.awesomeofficialstatistics.org" class="external-link"><img src="https://awesome.re/mentioned-badge.svg" alt="Mentioned in Awesome Official Statistics"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Steve Martin.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
